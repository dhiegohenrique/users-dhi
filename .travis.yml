language: csharp
solution: UsersDhi.sln
mono: none
dotnet: 2.0.0
notifications:
  email: false
services:
- mysql
- docker
script:
- dotnet restore
- cd IntegrationTests
- dotnet test
after_success:
- cd ..
- cd UsersDhi
- dotnet publish 
- docker login --username="$DOCKER_USERNAME" --password="$DOCKER_PASSWORD" registry.heroku.com
- docker build -t aspnet-on-heroku ./bin/Debug/netcoreapp1.1/publish
- docker tag aspnet-on-heroku registry.heroku.com/$APP_NAME/web
- docker push registry.heroku.com/$APP_NAME/web